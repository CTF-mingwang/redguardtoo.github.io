<html><body><div id="table-of-contents"> <h2>Table of Contents</h2> <div id="text-table-of-contents"> <ul> <li><a href="#sec-1">1 Reasons I need this hack</a></li> <li><a href="#sec-2">2 How to?</a></li> </ul> </div> </div>  <div id="outline-container-1" class="outline-3"> <h3 id="sec-1">Reasons I need this hack</h3> <div class="outline-text-3" id="text-1">  <ul> <li>Our current project used mix platforms (WIN64/Linux64), so the file path contains backward slash `\`. </li> <li>My p4 CLI program is from Windows installer because Cygwin version has the slash issue. </li> <li>Windows version of p4 has no such issue under Cygwin if we only feed it relative path. </li> </ul>  </div>  </div>  <div id="outline-container-2" class="outline-3"> <h3 id="sec-2">How to?</h3> <div class="outline-text-3" id="text-2">  <p>Create the patch, </p>   <pre class="src src-sh">p4 diff -du -db main-branch/... &gt; ~/mywork.patch
</pre>   <p> Go to the work directory of release branch. </p>   <pre class="src src-sh"><span style="color: #c397d8;">cd</span> dir-release-branch/

</pre>   <p> `p4 edit' the files I want to patch under release branch. Please note, </p><ul> <li>`lsdiff' is from the package `patchutils'. </li> <li>`nosl' will strip the backward/forward slashes. It's written by me. </li> </ul>     <pre class="src src-sh">cat ~/mywork.patch|lsdiff|nosl 5|p4 -x - edit

</pre>   <p> Patch the files and DONE! </p>   <pre class="src src-sh">patch -p5 &lt; ~/mywork.patch

</pre>   <p> Here is the source code of nosl. I put it in my .bashrc </p>   <pre class="src src-sh"><span style="color: #7aa6da;">nosl</span> ()

{
    <span style="color: #b9ca4a;">if</span> [ -z <span style="color: #70c0b1;">"$1"</span> ]; <span style="color: #b9ca4a;">then</span>
        <span style="color: #c397d8;">echo</span> <span style="color: #70c0b1;">"Usage: echo /hello/world|nosl num"</span>;
        <span style="color: #c397d8;">echo</span> <span style="color: #70c0b1;">"strip num leading slashes"</span>;
    <span style="color: #b9ca4a;">else</span>
        perl -pe <span style="color: #70c0b1;">"\$n=$1;while(\$n&gt;0){ \$_=~ s/[^\\\\\\/]*[\\\\\\/]+//;\$n--; }"</span>;
    <span style="color: #b9ca4a;">fi</span>
}

</pre>   <p> BTW, you could avoid all the trouble of <a href="http://www.perforce.com">Perforce</a> by switching to <a href="http://git-scm.com">Git</a>. </p></div> </div> </body></html>