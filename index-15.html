<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Linux, Programming, Emacs">
<meta name="viewport" content="width=device-width">
<title>Chen's blog (old posts, page 15) | Chen's blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://blog.binchen.org/index-15.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <section class="social"><ul>
<li><a href="index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="stories/about.html" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/chen_bin" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/redguardtoo" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
            
        <div class="post">
            <h1 class="title"><a href="posts/effective-spell-check-in-emacs.html">Effective spell check in Emacs</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-01-21T12:00:00+00:00">2014-01-21 12:00</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/effective-spell-check-in-emacs.html#disqus_thread" data-disqus-identifier="cache/posts/effective-spell-check-in-emacs.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs.html" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/linux.html" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="categories/spell.html" rel="tag">spell</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>
CREATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2014-01-21&gt;</span></span>
</p>

<p>
UPDATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2016-12-07 Wed&gt;</span></span>
</p>

<p>
I use <a href="http://www.emacswiki.org/emacs/FlySpell">Flyspell</a> in web-mode. But the solution works in other major modes.
</p>

<p>
I assume you already turn on <code>flyspell</code> for all the programming languages by inserting below code into <code>.emacs</code>,
</p>

<div class="org-src-container">

<pre><code class="lang-lisp">(add-hook 'prog-mode-hook 'flyspell-prog-mode)
</code></pre>

</div>

<p>
I also write a <a href="http://blog.binchen.org/posts/what-s-the-best-spell-check-set-up-in-emacs.html">short tutorial</a> on:
</p>

<ul class="org-ul">
<li>How to setup flyspell
</li>
<li>Difference between hunspell and aspell 
</li>
<li>How to setup hunspell
</li>
</ul>
<div id="outline-container-sec-1" class="outline-2">
<h3 id="sec-1">
<span class="section-number-2">1</span> Spell check in HTML</h3>
<div class="outline-text-2" id="text-1">
<p>
I will check,
</p>
<ul class="org-ul">
<li>Text between html tag like <code>&lt;label&gt;Please input email&lt;/label&gt;</code>
</li>
<li>Value of html input control like <code>&lt;input type</code>"text" value="Please input your name"&gt;=
</li>
<li>CSS class name like <code>&lt;div class</code>"btn btn-default" /&gt;=
</li>
</ul>
<p>
My setup:
</p>
<div class="org-src-container">


<pre><code class="lang-lisp">;; {{ flyspell setup for web-mode
(defun web-mode-flyspell-verify ()
  (let* ((f (get-text-property (- (point) 1) 'face))
         rlt)
    (cond
     ;; Check the words with these font faces, possibly.
     ;; this *blacklist* will be tweaked in next condition
     ((not (memq f '(web-mode-html-attr-value-face
                     web-mode-html-tag-face
                     web-mode-html-attr-name-face
                     web-mode-constant-face
                     web-mode-doctype-face
                     web-mode-keyword-face
                     web-mode-comment-face ;; focus on get html label right
                     web-mode-function-name-face
                     web-mode-variable-name-face
                     web-mode-css-property-name-face
                     web-mode-css-selector-face
                     web-mode-css-color-face
                     web-mode-type-face
                     web-mode-block-control-face)))
      (setq rlt t))
     ;; check attribute value under certain conditions
     ((memq f '(web-mode-html-attr-value-face))
      (save-excursion
        (search-backward-regexp "=['\"]" (line-beginning-position) t)
        (backward-char)
        (setq rlt (string-match "^\\(value\\|class\\|ng[A-Za-z0-9-]*\\)$"
                                (thing-at-point 'symbol)))))
     ;; finalize the blacklist
     (t
      (setq rlt nil)))
    rlt))
(put 'web-mode 'flyspell-mode-predicate 'web-mode-flyspell-verify)
;; }}
</code></pre>

</div>

<p>
I use <a href="http://web-mode.org/">web-mode</a> for HTML files. The technique applies on other modes (php-mode, html-mode ….) .
</p>

<p></p>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h3 id="sec-2">
<span class="section-number-2">2</span> Don't display doublon (double word) as error</h3>
<div class="outline-text-2" id="text-2">
<p>
Modern CSS frameworks like <a href="http://getbootstrap.com/">Bootstrap</a> make doublon unavoidable. For example, CSS class name <code>btn btn-default</code> contains double word <code>btn</code>.
</p>

<p>
So we need stop displaying doublon as error in HTML,
</p>
<div class="org-src-container">


<pre><code class="lang-lisp">(defvar flyspell-check-doublon t
  "Check doublon (double word) when calling `flyspell-highlight-incorrect-region'.")
 (make-variable-buffer-local 'flyspell-check-doublon)

(defadvice flyspell-highlight-incorrect-region (around flyspell-highlight-incorrect-region-hack activate)
  (if (or flyspell-check-doublon (not (eq 'doublon (ad-get-arg 2))))
      ad-do-it))

(defun web-mode-hook-setup ()
  (flyspell-mode 1)
  (setq flyspell-check-doublon nil))

(add-hook 'web-mode-hook 'web-mode-hook-setup)
</code></pre>

</div>

<p></p>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h3 id="sec-3">
<span class="section-number-2">3</span> Spell check camel case strings</h3>
<div class="outline-text-2" id="text-3">
<p>
We can check camel cased string/variable/function if and only if <a href="http://aspell.net/">aspell</a> is used.
</p>

<p>
Insert below code into <code>.emacs</code>,
</p>
<div class="org-src-container">


<pre><code class="lang-lisp">;; if (aspell installed) { use aspell}
;; else if (hunspell installed) { use hunspell }
;; whatever spell checker I use, I always use English dictionary
;; I prefer use aspell because:
;; 1. aspell is older
;; 2. looks Kevin Atkinson still get some road map for aspell:
;; @see http://lists.gnu.org/archive/html/aspell-announce/2011-09/msg00000.html
(setq ispell-program-name "aspell"
      ;; force the English dictionary, support Camel Case spelling check (tested with aspell 0.6)
      ispell-extra-args '("--sug-mode=ultra" "--lang=en_US" "--run-together" "--run-together-limit=5" "--run-together-min=2"))
</code></pre>

</div>

<p>
Please note the option <code>--run-together-min=2</code> means the <b>minimum length of each sub-word extracted from camel case string is two</b>. Please run <code>man aspell</code> in shell for details.
</p>

<p></p>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h3 id="sec-4">
<span class="section-number-2">4</span> Summary</h3>
<div class="outline-text-2" id="text-4">
<p>
<a href="http://www.emacswiki.org/emacs/FlySpell">EmacsWiki</a> suggests <code>(flyspell-prog-mode)</code> which only checks typo in comments.
</p>

<p>
But as I proved, Emacs gives you full freedom to design a <b>different</b> solution.
</p>

<p>
Screen shot (typos are underscored):
</p>


<div class="figure">
<p><img src="wp-content/spell-check-html-in-emacs.png" alt="spell-check-html-in-emacs.png"></p>
</div>
</div>

</div>

<div id="outline-container-sec-5" class="outline-2">
<h3 id="sec-5">
<span class="section-number-2">5</span> Javascript and ReactJS setup (OPTIONAL)</h3>
<div class="outline-text-2" id="text-5">
<p>
If you fully understand my previous sections, you don't need read this section.
</p>

<p>
Insert below code into <code>.emacs</code>, 
</p>
<div class="org-src-container">


<pre><code class="lang-lisp">(defun js-flyspell-verify ()
  (let* ((f (get-text-property (- (point) 1) 'face)))
    ;; *whitelist*
    ;; only words with following font face will be checked
    (memq f '(js2-function-call
              js2-function-param
              js2-object-property
              font-lock-variable-name-face
              font-lock-string-face
              font-lock-function-name-face))))
(put 'js2-mode 'flyspell-mode-predicate 'js-flyspell-verify)
(put 'rjsx-mode 'flyspell-mode-predicate 'js-flyspell-verify)
</code></pre>

</div>

<p></p>
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/how-to-execute-user-program-for-system-v-init-script.html">How to execute user program for System V init script</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-01-18T09:37:10+00:00">2014-01-18 09:37</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/how-to-execute-user-program-for-system-v-init-script.html#disqus_thread" data-disqus-identifier="cache/posts/how-to-execute-user-program-for-system-v-init-script.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/init.html" rel="tag">init</a></li>
           <li><a class="tag p-category" href="categories/linux.html" rel="tag">linux</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p>Memo for my self. </p>   
<pre class="prettyprint ">

sudo ls -1 /etc/{rc,init}.d/|grep local

# then read the file either rc.local or local
</pre>

<p></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/notes-on-google-chromes-dev-tool.html">Notes on Google Chrome's dev tool</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2014-01-13T12:32:00+00:00">2014-01-13 12:32</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/notes-on-google-chromes-dev-tool.html#disqus_thread" data-disqus-identifier="cache/posts/notes-on-google-chromes-dev-tool.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/chrome.html" rel="tag">chrome</a></li>
           <li><a class="tag p-category" href="categories/debug.html" rel="tag">debug</a></li>
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/google.html" rel="tag">google</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">javascript</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>C-[ or C-] to switch panel </li> <li>C-S-J to toggle dev tools and focus <b>Console panel</b>, see <a href="https://developers.google.com/chrome-developer-tools/docs/commandline-api">command line reference</a> </li> <li>C-S-I to toggle dev tools, then C-o to switch to <b>Sources panel</b> if needed </li> <li>C-S-C to <b>open</b> dev tools and focus on <b>Elements panel</b> </li> <li>See <a href="https://developers.google.com/chrome-developer-tools/docs/shortcuts">https://developers.google.com/chrome-developer-tools/docs/shortcuts</a> for all hot keys </li> <li>See <a href="https://developers.google.com/chrome-developer-tools/docs/javascript-debugging">https://developers.google.com/chrome-developer-tools/docs/javascript-debugging</a> </li> <li>Click <a href="http://javascript-library.googlecode.com/svn/trunk/javascript/goog/demos/hovercard.html">here</a> for test </li> </ul>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption> <colgroup>
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">command in source panel</th>
<th scope="col" class="left">hotkey</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Continue</td>
<td class="left">C-\</td>
</tr>
<tr>
<td class="left">Toggle break point</td>
<td class="left">C-B</td>
</tr>
<tr>
<td class="left">Step over</td>
<td class="left">C-'</td>
</tr>
<tr>
<td class="left">Step into</td>
<td class="left">C-;</td>
</tr>
<tr>
<td class="left">Step out</td>
<td class="left">S-C-;</td>
</tr>
<tr>
<td class="left">Up call stack</td>
<td class="left">C-,</td>
</tr>
<tr>
<td class="left">Down call stack</td>
<td class="left">C-.</td>
</tr>
<tr>
<td class="left">Toggle console view</td>
<td class="left">ESC</td>
</tr>
<tr>
<td class="left">Goto line</td>
<td class="left">C-G</td>
</tr>
<tr>
<td class="left">Goto file</td>
<td class="left">C-P</td>
</tr>
<tr>
<td class="left">Jump to method</td>
<td class="left">S-C-O</td>
</tr>
</tbody>
</table>
<ul>
<li>I don't use hotkey F1~F12 because my windows manager is different from most developers </li> <li>live editing does not work on Chromium 30.0.1599.114 Built on Ubuntu 13.04. Anyway, I don't need this functionality </li> <li>hotkeys of "Continue" button in <b>Sources panel</b> does not work on Chromium 30.0.1599.114 Built on Ubuntu 13.04. </li> <li>"Break on" inspected element is extremely useful </li> </ul>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/my-grub2-configuration.html">My grub2 configuration</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-12-31T19:09:00+00:00">2013-12-31 19:09</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/my-grub2-configuration.html#disqus_thread" data-disqus-identifier="cache/posts/my-grub2-configuration.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/grub.html" rel="tag">grub</a></li>
           <li><a class="tag p-category" href="categories/linux.html" rel="tag">linux</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p>/etc/grub.d/11_windows </p> <br><pre class="prettyprint ">
<h2>!/bin/sh -e</h2>
<p>echo "#        Adding Windows GRUB 2 menu"</p>
<p>cat &amp;lt;&amp;lt; EOF</p>
<p>menuentry "Windows XP" {</p>
<p>savedefault</p>
<p>insmod chain</p>
<p>insmod ntfs</p>
<p>set root=(hd0,1)</p>
<p>chainloader +1</p>
<p>}</p>
<p>EOF</p>
</pre>

<p></p>
<p> /etc/default/grub </p> <br><pre class="prettyprint ">
<h2>Copyright 1999-2013 Gentoo Foundation</h2>
<h2>Distributed under the terms of the GNU General Public License v2</h2>
<h2>$Header: /var/cvsroot/gentoo-x86/sys-boot/grub/files/grub.default-2,v 1.4 2013/09/21 18:10:55 floppym Exp $</h2>
<h2></h2>
<h2>To populate all changes in this file you need to regenerate your</h2>
<h2>grub configuration file afterwards:</h2>
<h2>'grub2-mkconfig -o /boot/grub/grub.cfg'</h2>
<h2></h2>
<h2>See the grub info page for documentation on possible variables and</h2>
<h2>their associated values.</h2>
<p>GRUB_DISTRIBUTOR="Gentoo"</p>
<p>GRUB_DEFAULT=saved</p>
<p>GRUB_SAVEDEFAULT=true</p>
<p>GRUB_HIDDEN_TIMEOUT=0</p>
<p>GRUB_HIDDEN_TIMEOUT_QUIET=true</p>
<p>GRUB_TIMEOUT=10</p>
<h2>Append parameters to the linux kernel command line</h2>
<p>GRUB_CMDLINE_LINUX="libata.dma=1"</p>
<h2>Append parameters to the linux kernel command line for non-recovery entries</h2>
<h2>GRUB_CMDLINE_LINUX_DEFAULT=""</h2>
<h2>Uncomment to disable graphical terminal (grub-pc only)</h2>
<h2>GRUB_TERMINAL=console</h2>
<h2>The resolution used on graphical terminal.</h2>
<h2>Note that you can use only modes which your graphic card supports via VBE.</h2>
<h2>You can see them in real GRUB with the command `vbeinfo'.</h2>
<h2>GRUB_GFXMODE=640x480</h2>
<h2>Path to theme spec txt file.</h2>
<h2>The starfield is by default provided with use truetype.</h2>
<h2>NOTE: when enabling custom theme, ensure you have required font/etc.</h2>
<h2>GRUB_THEME="/boot/grub/themes/starfield/theme.txt"</h2>
<h2>Background image used on graphical terminal.</h2>
<h2>Can be in various bitmap formats.</h2>
<h2>GRUB_BACKGROUND="/boot/grub/mybackground.png"</h2>
<h2>Uncomment if you don't want GRUB to pass "root=UUID=xxx" parameter to kernel</h2>
<h2>GRUB_DISABLE_LINUX_UUID=true</h2>
<h2>Uncomment to disable generation of recovery mode menu entries</h2>
<h2>GRUB_DISABLE_RECOVERY=true</h2>
</pre>

<p></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/why-emacs-is-better-editor.html">Why Emacs is better editor - a case study for javascript developer</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-12-15T19:02:00+00:00">2013-12-15 19:02</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/why-emacs-is-better-editor.html#disqus_thread" data-disqus-identifier="cache/posts/why-emacs-is-better-editor.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs.html" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/html.html" rel="tag">html</a></li>
           <li><a class="tag p-category" href="categories/javascript.html" rel="tag">javascript</a></li>
           <li><a class="tag p-category" href="categories/web.html" rel="tag">web</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p>UPDATED: <span class="timestamp-wrapper"> <span class="timestamp">2014-01-15 Wed</span></span> </p> <p> Let's see an example in real life development. </p> <div id="outline-container-1" class="outline-3"> <h4 id="sec-1">Note</h4> <div class="outline-text-3" id="text-1">  <p>For people who does not get the key points of this article, here are the points: </p>
<ul>
<li>Emacs has an embedded <b>javascript interpreter</b> which I extend a little bit. </li> <li>Other editors just use external tools or regular expression to do the semantic analysis. </li> <li>The difference of above two is bigger than the difference between machine gun and spear. </li> </ul>
</div>  </div>  <div id="outline-container-2" class="outline-3"> <h4 id="sec-2">Problem</h4> <div class="outline-text-3" id="text-2">  <p>I'm maintaining a big javascript file with thousands of lines of legacy code. </p> <p> My most urgent issue is how to list all the functions in that javascript file and jump to the definition of specific function easily. </p> <p> The modern enterprise application usually define the javascript function in some complex data structure. So most editors are not good at listing the functions. </p> <p> To understand what "complex" means, let's check some code from real world application: </p>   
<pre class="prettyprint ">

$(el.completeRegistrationForm).validate({
    ignore: " :hidden",
    rules : {
        password : {
            required : function () { return $(el.password).is(":visible"); }
        },
        accountNumber : {
            required : function () {
                return $(el.accountNumber).is(":visible");
            },
            digits : true
        }
        // ... I skipped next 200 lines which are similar to above lines

    },
    messages : {
        password: {
            required : "Please input a valid password"
        },
        accountNumber: {
            required : "Please provide a valid account number",
            digits : "Please enter only digits",
        }
        // ... I skipped next 200 lines which are similar to above lines
    }
});
</pre>

<p></p>
<p> Most editors like Sublime Text 3 cannot display the javascript functions with meaningful context in this case. All you can see is only a bunch of functions with name "required".: <img src="wp-content/uploads/2013/12/wpid-sublime-functions.png" alt="http://blog.binchen.org/wp-content/uploads/2013/12/wpid-sublime-functions.png"></p> </div>  </div>  <div id="outline-container-3" class="outline-3"> <h4 id="sec-3">Solution</h4> <div class="outline-text-3" id="text-3">  <p>Emacs has a <a href="http://www.emacswiki.org/emacs/Js2Mode">js2-mode</a> which is basically a javascript interpreter written in lisp. It's created by <a href="http://www.emacswiki.org/emacs/SteveYegge">Steve Yegge</a> and now maintained by <a href="https://github.com/mooz/js2-mode">mooz</a>. </p> <p> Since js2-mode is a interpreter, basically it can do anythig you want. The key point is to understand the <a href="http://en.wikipedia.org/wiki/Abstract_syntax_tree">Abstract Syntax Tree (AST)</a> defined in js2-mode. </p>
<p> I already submitted the patch to mooz so everyone will enjoy this feature in the future. </p>

<p></p>
<p> Here is the screen shot of emacs in old js2-mode, the UI is based on <a href="http://www.emacswiki.org/emacs/ImenuMode">Imenu Mode</a> and <a href="https://github.com/emacs-helm/helm">helm</a>: <img src="wp-content/uploads/2013/12/wpid-emacs-functions.png" alt="http://blog.binchen.org/wp-content/uploads/2013/12/wpid-emacs-functions.png"></p> <p> The screen shot after we applying the above patch:  <img src="wp-content/uploads/2013/12/wpid-emacs-functions-improved.png" alt="http://blog.binchen.org/wp-content/uploads/2013/12/wpid-emacs-functions-improved.png"></p> </div>  </div>  <div id="outline-container-4" class="outline-3"> <h4 id="sec-4">Summary</h4> <div class="outline-text-3" id="text-4">  <p>That's an example of beauty of Emacs. </p> <p> It gives you freedom and power. You can base your work on the top geeks like Steve Yegge and mooz. Just a few lines of lisp code to kick ass. </p>
</div>  </div>  <div id="outline-container-5" class="outline-3"> <h4 id="sec-5">Update</h4> <div class="outline-text-3" id="text-5">  <p>My patch is incorporated into js2-mode since version 20140114. You can install it through emacs package manager. </p> <p> After installing js2-mode, you need paste only one line code into your ~/.emacs to enable the feature: </p>   
<pre class="prettyprint ">
(js2-imenu-extras-mode)
</pre>

<p></p>
<p> The UI to display the candidate in this actile is from package <a href="https://github.com/emacs-helm/helm">helm</a>. But there are many other UI front end for imenu instead of helm. </p> <p> The helm version should be 20140125.1101 or higher, you can install helm from <a href="http://melpa.milkbox.net/">melpa</a>. </p> <p> After installing helm, you can use command "M-x helm-imenu" to show the list of functions to jump to. Here is the screen shot how I use imenu in my <a href="https://github.com/redguardtoo/hello/raw/master/hello2.js">hello2.js</a>: </p> <p> <img src="wp-content/uploads/2014/01/wpid-helm-imenu-and-js2-mode-nq8.png" alt="http://blog.binchen.org/wp-content/uploads/2014/01/wpid-helm-imenu-and-js2-mode-nq8.png"></p>
</div> </div> </div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/why-some-systemd-service-on-archlinux-does-not-work.html">Why some systemd service on ArchLinux does not work</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-12-01T14:53:00+00:00">2013-12-01 14:53</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/why-some-systemd-service-on-archlinux-does-not-work.html#disqus_thread" data-disqus-identifier="cache/posts/why-some-systemd-service-on-archlinux-does-not-work.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/archlinux.html" rel="tag">archlinux</a></li>
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/systemd.html" rel="tag">systemd</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<div id="outline-container-1" class="outline-3"> <h4 id="sec-1">List failed services</h4> <div class="outline-text-3" id="text-1">     
<pre class="prettyprint ">

sudo systemctl --failed
</pre>

<p></p>
<p> I can also use <code>sudo journalctl -b</code> to get the log message when booting all the services. But not very useful. </p>
</div>  </div>  <div id="outline-container-2" class="outline-3"> <h4 id="sec-2">Find the root cause of failed service</h4> <div class="outline-text-3" id="text-2">     
<pre class="prettyprint ">

sudo systemctl status service-name
</pre>

<p></p>
</div>  </div>  <div id="outline-container-3" class="outline-3"> <h4 id="sec-3">Why my /usr/lib/systemd/system/network-wifi.service does not work</h4> <div class="outline-text-3" id="text-3">  <p>Here is the content of my wifi service </p>   
<pre class="prettyprint ">

[Unit]

Description=Wireless networkd connectivity (wlan0)

Wants=network.target

Before=network.target

BindsTo=sys-subsystem-net-devices-wlan0.device

After=sys-subsystem-net-devices-wlan0.device



[Service]

Type=oneshot

RemainAfterExit=yes

#EnvironmentFile=/etc/conf.d/network-wireless@wlan0



ExecStart=/usr/bin/ip link set wlan0 up

ExecStart=/usr/bin/wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/yang.conf

ExecStart=/usr/bin/dhcpcd wlan0



ExecStop=/usr/bin/ip addr flush dev wlan0

ExecStop=/usr/bin/ip link set dev wlan0 down



[Install]

WantedBy=multi-user.target
</pre>

<p></p>
<p> It's because netcfg.service blocks my network-wifi.service. </p> <p> Solutin is simple: </p>   
<pre class="prettyprint ">

sudo systemctl disable netcfg
</pre>

<p></p>
</div>  </div>  <div id="outline-container-4" class="outline-3"> <h4 id="sec-4">How to start a service as as specific user (mpd, for example)</h4> <div class="outline-text-3" id="text-4">  <p>This is the content of /usr/lib/systemd/system/mpd.service:  </p>   
<pre class="prettyprint ">

[Unit]

Description=Music Player Daemon

After=network.target sound.target



[Service]

ExecStart=/usr/bin/mpd --no-daemon /home/cb/.mpd/config

User=cb



[Install]

WantedBy=multi-user.target
</pre>

<p></p>
</div> </div> </div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/hao-you-shen-cai-zuo-fa.html">蚝油生菜做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-11-17T19:43:00+00:00">2013-11-17 19:43</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/hao-you-shen-cai-zuo-fa.html#disqus_thread" data-disqus-identifier="cache/posts/hao-you-shen-cai-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/beef.html" rel="tag">beef</a></li>
           <li><a class="tag p-category" href="categories/cuisine.html" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/garlic.html" rel="tag">garlic</a></li>
           <li><a class="tag p-category" href="categories/zh.html" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>
<a href="http://www.xinshipu.com/%E7%AE%80%E6%98%93%E7%89%88%E8%9A%9D%E6%B2%B9%E7%94%9F%E8%8F%9C-15533.htm">菜谱</a> </li> <li>油炸蒜末,倒入蚝油(至少4大勺)搅拌,最后放入生菜(半颗),搅拌一下即可,可以最后放盐如果嫌不咸的话 </li> <li>生菜用开水烫过沥干,因为其容易出水 </li> <li>不要放糖,蚝油本身有甜味了 </li> </ul>
<p>阿基师的做法 </p>   <pre class="example">小叮嚀:
<p>1.西生菜要集中加熱（顏色才可以保持鮮綠跟脆口）</p>
<p>2.可以利用香菇去蠔油腥味</p>
<p>2.1. 利用香菇去做燴的動作，讓一些物料巴在上頭</p>
<p>2.2. 不要加雞精粉跟糖，蠔油已經有甜度了。</p>
<p>2.3. 蠔油跟豬油一起拌會更香</p>
<p>做法:</p>
<p>1.去除香菇蒂頭，斜刀將香菇切片。</p>
<p>2.起鍋下1茶匙油，爆香香菇片，下蠔油拌炒〈炒過的蠔油有焦糖味在裡面， 味道會更香〉，加入自來高湯〈自來高湯的量，只要抓蠔油鹹度即可〉，小滾一會兒， 讓香菇的甜味煮出來。</p>
<p>3.調太白粉水〈粉1：水3〉，加入適量的太白粉水，加入少許香油，不需攪拌，熄火 〈澱粉會吃油，攪拌的話會膨脹變成一團糊〉。</p>
<p>4.在滾水鍋中加鹽，汆燙西生菜〈菜要最後汆燙〉，加入少許薑末〈薑汁也行，薑可提味，巴在葉片上會更好吃〉汆燙，撈起西生菜瀝乾水份〈因為西生菜很會出水， 一定要徹底瀝乾水份，否則會水水的〉。</p>
<p>5.將蠔油醬汁淋在西生菜上即可。</p>
<p></p></pre>  <p> -<a href="http://www.youtube.com/watch?feature=player_detailpage&amp;v=X5fY_CtpUGo#t=1731">阿基师视频</a> </p> <p> Screen shot: <img src="wp-content/uploads/2013/11/wpid-fried-cabbage.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/11/wpid-fried-cabbage.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/memo-on-upgrading-archlinux.html">Memo on upgrading ArchLinux</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-11-03T20:29:55+00:00">2013-11-03 20:29</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/memo-on-upgrading-archlinux.html#disqus_thread" data-disqus-identifier="cache/posts/memo-on-upgrading-archlinux.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/gentoo.html" rel="tag">gentoo</a></li>
           <li><a class="tag p-category" href="categories/linux.html" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="categories/upgrade.html" rel="tag">upgrade</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<pre class="prettyprint ">

<h2>shit happens</h2>
<p>pacman -Syu </p>
<h2>archlinux replace grub with grub2</h2>
<h2>I cannot install grub2, blocklists stuff</h2>
<h2>downgrade to grub-obsolete</h2>
<h2>then grub</h2>
<h2>setup (hd0) to install MBR</h2>
<h2>restart netbook (make sure the boot priority is right)</h2>
</pre>

<p></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/notes-on-upgrading-gentoo-linux.html">notes on upgrading Gentoo Linux</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-26T19:47:54+00:00">2013-10-26 19:47</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/notes-on-upgrading-gentoo-linux.html#disqus_thread" data-disqus-identifier="cache/posts/notes-on-upgrading-gentoo-linux.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/gentoo.html" rel="tag">gentoo</a></li>
           <li><a class="tag p-category" href="categories/linux.html" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="categories/upgrade.html" rel="tag">upgrade</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<pre class="prettyprint ">

<p>sudo emerge --update --deep --with-bdeps=y --newuse world
</p></pre>
<p></p>
<ul>
<li>I get notified that some newer version package is required, so I have to manually install those package and re-run the <code>emerge world</code> </li> <li>Some package is gone (libreoffice-bin, for example). </li> </ul>
<p> Here is command to manually install package: </p>   
<pre class="prettyprint ">

sudo ebuild /usr/portage/www-client/firefox-bin/firefox-bin-23.0.ebuild unpack compile install qmerge clean
</pre>

<p></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html">How to take screen shot for business people efficiently in Emacs</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-23T17:31:00+00:00">2013-10-23 17:31</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#disqus_thread" data-disqus-identifier="cache/posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs.html" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en.html" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/linux.html" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="categories/office.html" rel="tag">office</a></li>
           <li><a class="tag p-category" href="categories/org.html" rel="tag">org</a></li>
           <li><a class="tag p-category" href="categories/screenshot.html" rel="tag">screenshot</a></li>
           <li><a class="tag p-category" href="categories/word.html" rel="tag">word</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<div id="table-of-contents">
<h3>Table of Contents</h3>
<div id="text-table-of-contents">
<ul>
<li><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#sec-1">1. Tools</a></li>
<li>
<a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#sec-2">2. Work flow</a>
<ul>
<li><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#sec-2-1">2.1. Use scrot to screenshot and put its path into clipboard</a></li>
<li><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#sec-2-2">2.2. Create org file and insert path of screen shot</a></li>
<li><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#sec-2-3">2.3. Convert org file into Microsoft Word format</a></li>
<li><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html#sec-2-4">2.4. Tips</a></li>
</ul>
</li>
</ul>
</div>
</div>

<p>
CREATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2013-10-23 Wed&gt;</span></span>
</p>

<p>
UPDATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2015-08-11 Tue&gt;</span></span>
</p>

<div id="outline-container-sec-1" class="outline-2">
<h3 id="sec-1">
<span class="section-number-2">1</span> Tools</h3>
<div class="outline-text-2" id="text-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="left">
<col class="left">
<col class="left">
</colgroup>
<thead><tr>
<th scope="col" class="left">Name</th>
<th scope="col" class="left">Description</th>
<th scope="col" class="left">Minimum version</th>
</tr></thead>
<tbody>
<tr>
<td class="left">Org-mode</td>
<td class="left">create org-file which could be converted to odt file</td>
<td class="left">7.8</td>
</tr>
<tr>
<td class="left">scrot</td>
<td class="left">command line tool to take screen shot</td>
<td class="left">any version</td>
</tr>
<tr>
<td class="left"><a href="https://www.libreoffice.org/download/libreoffice-fresh/">Libreoffice</a></td>
<td class="left">convert odt to Microsoft Word</td>
<td class="left">any version</td>
</tr>
<tr>
<td class="left">xsel</td>
<td class="left">X clipboard tool</td>
<td class="left">any version</td>
</tr>
</tbody>
</table>
</div>

<p></p>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h3 id="sec-2">
<span class="section-number-2">2</span> Work flow</h3>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-sec-2-1" class="outline-3">
<h4 id="sec-2-1">
<span class="section-number-3">2.1</span> Use scrot to screenshot and put its path into clipboard</h4>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre><code class="lang-bash">scrot '%H%M%S-%d_$wx$h.png' -e 'mkdir -p ~/screenshot;mv $f ~/screenshot/;echo ~/screenshot/$f|tr -d \"\\n\"|xsel -ib;'
</code></pre>

<p></p>
</div>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h4 id="sec-2-2">
<span class="section-number-3">2.2</span> Create org file and insert path of screen shot</h4>
<div class="outline-text-3" id="text-2-2">
<p>
Actually I use below elisp command to do the insertion for me.
</p>
<div class="org-src-container">

<pre><code class="lang-lisp">(defun insert-file-link-from-clipboard ()
  "Make sure the full path of file exist in clipboard. This command will convert
The full path into relative path and insert it as a local file link in org-mode"
  (interactive)
  (let (str)
    (with-temp-buffer
      (shell-command
       (cond
        ((eq system-type 'cygwin) "getclip")
        ((eq system-type 'darwin) "pbpaste")
        (t "xsel -ob"))
       1)
      (setq str (buffer-string)))

    ;; convert to relative path (relative to current buffer) if possible
    (let ((m (string-match (file-name-directory (buffer-file-name)) str) ))
      (when m
        (if (= 0 m )
            (setq str (substring str (length (file-name-directory (buffer-file-name)))))
          ))
        (insert (format "[[file:%s]]" str)))
    ))
</code></pre>

</div>

<p></p>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h4 id="sec-2-3">
<span class="section-number-3">2.3</span> Convert org file into Microsoft Word format</h4>
<div class="outline-text-3" id="text-2-3">
<p>
I'm sure this method works even on Windows. But I don't have Windows PC to validate my belief. Libreoffice is required.
</p>
<p>
Run the command "M-x org-export-as-odt".
</p>

<p>
Word document is <b>automatically created</b> if you insert below code into your ~/.emacs:
</p>

<div class="org-src-container">

<pre><code class="lang-lisp">;; This setup is tested on Emacs 24.3 &amp; Emacs 24.4 on Linux/OSX
;; org v7 bundled with Emacs 24.3
(setq org-export-odt-preferred-output-format "doc")
;; org v8 bundled with Emacs 24.4
(setq org-odt-preferred-output-format "doc")
;; BTW, you can assign "pdf" in above variables if you prefer PDF format

;; Only OSX need below setup
(defun my-setup-odt-org-convert-process ()
  (interactive)
  (let ((cmd "/Applications/LibreOffice.app/Contents/MacOS/soffice"))
    (when (and (eq system-type 'darwin) (file-exists-p cmd))
      ;; org v7
      (setq org-export-odt-convert-processes '(("LibreOffice" "/Applications/LibreOffice.app/Contents/MacOS/soffice --headless --convert-to %f%x --outdir %d %i")))
      ;; org v8
      (setq org-odt-convert-processes '(("LibreOffice" "/Applications/LibreOffice.app/Contents/MacOS/soffice --headless --convert-to %f%x --outdir %d %i"))))
    ))
(my-setup-odt-org-convert-process)
</code></pre>

</div>

<p>
Emacs will find the binary "soffice" from libreoffice to do the conversion.
</p>

<p></p>
</div>
</div>
<div id="outline-container-sec-2-4" class="outline-3">
<h4 id="sec-2-4">
<span class="section-number-3">2.4</span> Tips</h4>
<div class="outline-text-3" id="text-2-4">
<p>
If you need page break in exported document, insert below snippet into the org file:
</p>
<div class="org-src-container">

<pre><code class="lang-html">#+ODT: &lt;text:p text:style-name="PageBreak"/&gt;
</code></pre>

</div>

<p></p>
</div>
</div>
</div>
</div>
            </div>
        </div>
    
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-16.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-14.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="chenbin0";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2016         <a href="mailto:chenbin.sh@gmail.com">Chen Bin</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
         document.addEventListener('DOMContentLoaded', function() {
           var items = document.getElementsByClassName('timeago'), e, pd;
           for (var i = 0; i < items.length; i++) {
             e = items[i];
             pd = moment(new Date(e.getAttribute('datetime')));
             e.innerHTML = pd.fromNow();
             e.setAttribute('title', pd.format('LLLL'));
           }
         });
        </script>
</body>
</html>
