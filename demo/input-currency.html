<!DOCTYPE html>
<html ng-app="myApp">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <title>Angular Sandbox (with Bootstrap)</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.20/angular.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.11.2/ui-bootstrap-tpls.min.js"></script>
    <link type="text/css" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.1/css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css" />
    <style type="text/css">.nav, .pagination, .carousel, .panel-title a { cursor: pointer; } /* angular ui bootstrap hack */</style>
  </head>
  <body>
    <div class="row">
      <div class="col-sm-12">
        <div ng-controller="MainCtrl">
          <form method="" action="">
            <div>
              <label class="className" for="v1">$</label>
              <input input-currency type="text" name="v1" value="" ng-model="formData.v1"/>
              <span>{{ formData.v1 }}</span>
            </div>
            <div>
              <label class="className" for="v2">Input 2:</label>
              <input type="text" name="v1" value="" ng-model="formData.v2"/>
              <span>{{ formData.v2 }}</span>
            </div>
          </form>
        </div>
      </div>
    </div>
    <script type="text/javascript">
     var app = angular.module('myApp', ['ui.bootstrap']);
     app.controller('MainCtrl', function ($scope) {
       $scope.formData = {
         v1: 39,
         v2: 'hello'
       };
     });

     app.directive('inputCurrency', function($filter) {
       return {
         restrict: 'A',
         require: 'ngModel',
         link: function(scope, element, attr, ngModel) {
           var elementFocused;
           var forceDataBinding = function(ctrl) {
             var value = ctrl.$modelValue;
             var formatters = ctrl.$formatters,
             idx = formatters.length;

             while(idx--) {
               value = formatters[idx](value);
             }

             if (ctrl.$viewValue !== value) {
               ctrl.$viewValue = value;
               ctrl.$render();
             }
           };
           element.on('focus', function () {
             elementFocused = true;
             forceDataBinding(ngModel);
           });
           element.on('blur', function () {
             elementFocused = false;
             forceDataBinding(ngModel);
           });
           ngModel.$parsers.push(function (v) {
             // from user input
             if(typeof(v) === 'string') {
               v = v.replace(/\.\d\d$/,'');
               v = v.replace(/, */,'');
               v = parseInt(v, 10);
             }
             return v;
           });
           ngModel.$formatters.push(function (v) {
             // to user input
             if(elementFocused === true) {
               return v;
             }
             return $filter('currency')(v,'');
           });
         }
       };
     });
    </script>
  </body>
</html>